From 985c5b1cf2101c9824076b5fe1062b589f81f168 Mon Sep 17 00:00:00 2001
From: John Crispin <john@phrozen.org>
Date: Wed, 3 Nov 2021 14:33:31 +0100
Subject: [PATCH 49/51] kernel-headers: add v3.18->v5.10 support

Signed-off-by: John Crispin <john@phrozen.org>
---
 toolchain/kernel-headers/Makefile | 8 +++++++-
 1 file changed, 7 insertions(+), 1 deletion(-)

diff --git a/toolchain/kernel-headers/Makefile b/toolchain/kernel-headers/Makefile
index 06236b5a47..df6e734bc2 100644
--- a/toolchain/kernel-headers/Makefile
+++ b/toolchain/kernel-headers/Makefile
@@ -14,9 +14,15 @@ override HOST_QUILT:=
 
 include $(INCLUDE_DIR)/target.mk
 
-ifeq ($(KERNEL_PATCHVER),4.4)
+
+ifneq ($(filter 3.18 4.4,$(KERNEL_PATCHVER)),)
   KERNEL_PATCHVER := 5.10
   KERNEL_NAME_SUFFIX:=
+  GENERIC_BACKPORT_DIR := $(GENERIC_PLATFORM_DIR)/backport$(if $(wildcard $(GENERIC_PLATFORM_DIR)/backport-$(KERNEL_PATCHVER)),-$(KERNEL_PATCHVER))
+  GENERIC_PATCH_DIR := $(GENERIC_PLATFORM_DIR)/pending$(if $(wildcard $(GENERIC_PLATFORM_DIR)/pending-$(KERNEL_PATCHVER)),-$(KERNEL_PATCHVER))
+  GENERIC_HACK_DIR := $(GENERIC_PLATFORM_DIR)/hack$(if $(wildcard $(GENERIC_PLATFORM_DIR)/hack-$(KERNEL_PATCHVER)),-$(KERNEL_PATCHVER))
+  GENERIC_FILES_DIR := $(foreach dir,$(wildcard $(GENERIC_PLATFORM_DIR)/files $(GENERIC_PLATFORM_DIR)/files-$(KERNEL_PATCHVER)),"$(dir)")
+  $(warning GENERIC_BACKPORT_DIR = $(GENERIC_BACKPORT_DIR))
 endif
 
 include $(INCLUDE_DIR)/kernel-version.mk
-- 
2.25.1

